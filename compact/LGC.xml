<lccdd>

<info name="LGC" title="Light Gas Cherenkov"
  author="C. Peng"
  url="https://eicweb.phy.anl.gov/EIC/detectors/solid/-/blob/master/compact/LGC.xml"
  status="development"
  version="$Id: compact/LGC.xml v1.0 2024-05-18$">
  <comment>SoLID Light Gas Cherenkov Detector</comment>
</info>

<readouts>
  <readout name="LightGasCherenkovHits">
    <segmentation type="CartesianGridXY" grid_size_x="3*mm" grid_size_y="3*mm" />
    <id>system:6,sector:12,module:14,x:32:-16,y:-16</id>
  </readout>
</readouts>

<define>
  <comment>
    start ppint of LGC
  </comment>
  <constant name="LGC_x" value="0" />
  <constant name="LGC_y" value="0" />
  <constant name="LGC_z" value="97.0*cm" />

  <comment>
    a list of constants from the LGC geometry table to help build mirror geometry
    the mirror is built by intersection between a spherical shell and a trapezoid (wedge)
    note these coordinates are in world volume, the geometry plugin is supposed to transform them to the Cherenkov volume coordinates
  </comment>
  <constant name="LGC_inner_shell_rmin" value="299.15*cm" />
  <constant name="LGC_inner_shell_rmax" value="299.45*cm" />
  <constant name="LGC_inner_shell_x" value="0.*cm" />
  <constant name="LGC_inner_shell_y" value="274.7*cm" />
  <constant name="LGC_inner_shell_z" value="24.9*cm" />

  <constant name="LGC_outer_shell_rmin" value="160.09*cm" />
  <constant name="LGC_outer_shell_rmax" value="160.39*cm" />
  <constant name="LGC_outer_shell_x" value="0.*cm" />
  <constant name="LGC_outer_shell_y" value="200.86*cm" />
  <constant name="LGC_outer_shell_z" value="143.06*cm" />

  <comment>
    wedge corner coordinates
  </comment>
  <constant name="LGC_inner_wedge_P2_x" value="18.23*cm"/>
  <constant name="LGC_inner_wedge_P2_y" value="173.42*cm"/>
  <constant name="LGC_inner_wedge_P2_z" value="305.82*cm"/>

  <constant name="LGC_inner_wedge_P4_x" value="7.57*cm"/>
  <constant name="LGC_inner_wedge_P4_y" value="72.02*cm"/>
  <constant name="LGC_inner_wedge_P4_z" value="244.82*cm"/>

  <constant name="LGC_outer_wedge_P2_x" value="21.76*cm"/>
  <constant name="LGC_outer_wedge_P2_y" value="207.05*cm"/>
  <constant name="LGC_outer_wedge_P2_z" value="301.54*cm"/>

  <constant name="LGC_outer_wedge_P4_x" value="19.03*cm"/>
  <constant name="LGC_outer_wedge_P4_y" value="181.06*cm"/>
  <constant name="LGC_outer_wedge_P4_z" value="300.77*cm"/>

  <comment>
    dimension calculations (position is relative to the shell)
  </comment>
  <constant name="LGC_inner_wedge_dx1" value="abs(LGC_inner_wedge_P4_x)" />
  <constant name="LGC_inner_wedge_dx2" value="abs(LGC_inner_wedge_P2_x)" />
  <constant name="LGC_inner_wedge_dy"  value="abs(LGC_inner_wedge_P2_y - LGC_inner_wedge_P4_y)/2." />
  <constant name="LGC_inner_wedge_dz"  value="abs(LGC_inner_wedge_P2_z - LGC_inner_wedge_P4_z)/2. + 10*cm" />
  <constant name="LGC_inner_wedge_x"   value="0. - LGC_inner_shell_x" />
  <constant name="LGC_inner_wedge_y"   value="(LGC_inner_wedge_P2_y + LGC_inner_wedge_P4_y)/2. - LGC_inner_shell_y"/>
  <constant name="LGC_inner_wedge_z"   value="(LGC_inner_wedge_P2_z + LGC_inner_wedge_P4_z)/2. - LGC_inner_shell_z"/>

  <constant name="LGC_outer_wedge_dx1" value="abs(LGC_outer_wedge_P4_x)" />
  <constant name="LGC_outer_wedge_dx2" value="abs(LGC_outer_wedge_P2_x)" />
  <constant name="LGC_outer_wedge_dy"  value="abs(LGC_outer_wedge_P2_y - LGC_outer_wedge_P4_y)/2." />
  <constant name="LGC_outer_wedge_dz"  value="abs(LGC_outer_wedge_P2_z - LGC_outer_wedge_P4_z)/2. + 10*cm" />
  <constant name="LGC_outer_wedge_x"   value="0. - LGC_outer_shell_x" />
  <constant name="LGC_outer_wedge_y"   value="(LGC_outer_wedge_P2_y + LGC_outer_wedge_P4_y)/2. - LGC_outer_shell_y"/>
  <constant name="LGC_outer_wedge_z"   value="(LGC_outer_wedge_P2_z + LGC_outer_wedge_P4_z)/2. - LGC_outer_shell_z"/>
</define>

<detectors>
<comment>
  Light Gas Cherenkov Detector: Begin
</comment>
<detector
  id="7"
  name="LightGasCherenkov"
  type="SoLID_GasCherenkov"
  readout="LightGasCherenkovHits"
  numsides="24"
  vis="RedVis">

  <placement x="LGC_x" y="LGC_y" z0="LGC_z" />
  <tank radiator="N2Optical">
    <comment> snout </comment>
    <segment rmin1="48.7*cm" rmax1="120*cm" rmin2="59.7*cm" rmax2="130*cm" length="97*cm" />
    <segment rmin1="59.7*cm" rmax1="130*cm" rmin2="61.5*cm" rmax2="145*cm" length="16*cm" />
    <segment rmin1="61.5*cm" rmax1="145*cm" rmin2="63.4*cm" rmax2="163*cm" length="22*cm" />
    <comment> tank </comment>
    <segment rmin1="63.4*cm" rmax1="263*cm" rmin2="73.2*cm" rmax2="263*cm" length="80*cm" />
  </tank>

  <comment>
    mirrors placement
    mirror is the intersection between two spherical shell
  </comment>
  <mirrors>
    <piece id="1" material="PyrexGlassOptical" surface="MirrorOpticalSurface">
      <placement x="LGC_inner_shell_x" y="LGC_inner_shell_y" z="LGC_inner_shell_z - LGC_z"/>
      <shell rmin="LGC_inner_shell_rmin" rmax="LGC_inner_shell_rmax" theta0="0" dtheta="90*degree" phi0="0" dphi="360*degree"/>
      <wedge dx1="LGC_inner_wedge_dx1" dx2="LGC_inner_wedge_dx2"
        dy="LGC_inner_wedge_dy" dz="LGC_inner_wedge_dz"
        x="LGC_inner_wedge_x" y="LGC_inner_wedge_y" z="LGC_inner_wedge_z"
        rotx="90*degree" roty="0" rotz="0"/>
    </piece>
    <piece id="2" material="PyrexGlassOptical" surface="MirrorOpticalSurface">
      <placement x="LGC_outer_shell_x" y="LGC_outer_shell_y" z="LGC_outer_shell_z - LGC_z"/>
      <shell rmin="LGC_outer_shell_rmin" rmax="LGC_outer_shell_rmax" theta0="0" dtheta="90*degree" phi0="0" dphi="360*degree"/>
      <wedge dx1="LGC_outer_wedge_dx1" dx2="LGC_outer_wedge_dx2"
        dy="LGC_outer_wedge_dy" dz="LGC_outer_wedge_dz"
        x="LGC_outer_wedge_x" y="LGC_outer_wedge_y" z="LGC_outer_wedge_z"
        rotx="90*degree" roty="0" rotz="0"/>
    </piece>
  </mirrors>

  <comment>
    Light Gas Cherenkov: Winston cones
  </comment>
  <winston_cone material="PyrexGlassOptical" surface="MirrorOpticalSurface">
    <placement x="0*cm" y="240*cm" z="245*cm - LGC_z"/>
    <rotation x="0" y="0" z="0"/>
    <comment> TODO: implement PMT material layers </comment>
    <pmt_array dx="16*cm" dy="16*cm" sensitive="yes"/>
    <cone thickness="4*mm" rmin="7.0*cm" rmax="21.5*cm" length="30.*cm"/>
    <shield material="Lead" thickness="1.*cm" radius="11.53*cm" length="15.*cm" shift_z="-1.66*cm"/>
  </winston_cone>
</detector>
<comment>
  Light Gas Cherenkov Detector: End
</comment>

</detectors>
</lccdd>
